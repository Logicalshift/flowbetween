
use super::*;

use std::time::{Duration};

#[test]
fn fill_three_circles() {
    let edits = "SAAAAAAAAeCEAAAAAAA4QCE
        +A
        LANHMFWelJHIxA
        LA+tAAAAAA
        LAPtAAAAAA*+BIAAAAg+AAAAoABAAAICB+
        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
        LAPtAAAAAA*+EIAAAAg+AAAAoABAAAICB+
        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
        LAPtAAAAAA*+HIAAAAg+AAAAoABAAAICB+
        LAPtAAAAAAP+IAAAAg/AAAAg/ArAAQmZmZW//P
        LAPtAAAAAAF+JAAAAAwLX0BEAAAAguzCHCEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABB
        LAPtAAAAAA*+KIAAAAg+AAAAoABAAAICB+
        LAPtAAAAAAP+LAAAAg/AAAAg/ArAAQmZmZW//P
        LAPtAAAAAAF+MAAAAAAAIsBEAAAAANzCHCEAAAAAAAAAAAA
        AAAAAAAAAAAAAAAAAAAAABB
        LAPtAAAAAA*+NIAAAAg+AAAAoABAAAICB+
        LAPtAAAAAAP+OAAAAg/AAAAg/ArAAQmZmZW//P
        LAPtAAAAAAF+PAAAAAzMBiBEAAAAANTNHCEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABB
    ";

    // Run the edits
    let mut animation = create_animation();
    perform_serialized_edits(&mut animation, edits);

    // Animation should contain a single layer and a frame with three brush strokes and three fill paths in it
    let layer       = animation.get_layer_with_id(0).unwrap();
    let frame       = layer.get_frame_at_time(Duration::from_millis(0));
    let elements    = frame.vector_elements().unwrap().collect::<Vec<_>>();

    assert!(elements.len() == 6);
}
